<!--
  iFrame Component for HapYak
  bobaks@google.com

  Listens for data from the HapYak user login form, stores it in variables
  Generates a pop-up window with data from the variables
  The HTML for the pop-up is embedded in the script, through it could also be linked

-->



<!doctype html>
<html>
	<head>
		<title></title>
		<meta charset="utf-8"/>
		<style type="text/css">
			html, body { margin: 0; padding: 0 }
		</style>
	</head>
	<body>
		<!-- BEGIN: iFrame's HTML code -->

		<!-- This example has a button that runs the function openNewWindow() -->
		<button onclick="openNewWindow();">PUSH ME</button>

		<!-- END: iFrame's HTML code -->


		<script type="text/javascript" src="//d2qrdklrsxowl2.cloudfront.net/js/hapyak-iframe.js"></script>
		<script type="text/javascript" src="//d2qrdklrsxowl2.cloudfront.net/js/hapyak.api.js"></script>


		<!-- BEGIN: Custom JavaScript -->
		<script type="text/javascript">

			// Global Variables
			var userName, userId, email;

			// This function will open a new window. Called from the HTML button above
			function openNewWindow() {
				var popupWindow = window.open("", "MsgWindow", "width=800,height=600");
				var popupHTML = `<p>This is 'MsgWindow'. I am 800px wide and 600px tall!</p> \
					<p>Your user name is ${userName}</p> \
					<p>The end.</p>`;

					popupWindow.document.write(popupHTML);
				}


			// BEGIN: HapYak event listener code
			(function () {
				hapyak.context.addEventListener('data', function (variables) {
        			if (variables._hapyakTrackingUserEmail) {
						email =  variables._hapyakTrackingUserEmail;
       			 	}
        			if (variables._hapyakTrackingUser) {
             			userId = variables._hapyakTrackingUser;
        		   	}
        			if (variables._hapyakTrackingUserName) {
             		   	userName = variables._hapyakTrackingUserName;
        			}

        			console.log("iframe data", variables);
   				});
			}());
			// END: HapYak event listener code

		</script>

	<!-- END: Custom JavaScript -->
	</body>
</html>
